\documentclass[a4paper]{article}

% SEE ALSO : unittest_colormap_input.tex

\usepackage{pgfplots}

\usepackage{pgfplots.assert}

\begin{document}

%\tracingcommands=2\tracingmacros=2
%

\makeatletter

\pgfplotsset{
	colormap={initial}{rgb=(0,0,0) rgb=(1,0,0)},
}
{

\pgfplotscolormapserializetomacro{initial}\initial
\def\expected{%
	\expandafter \def \csname pgfpl@cm@initial@h\endcsname {1000.0}%
	\expandafter \def \csname pgfpl@cm@initial@invh\endcsname {0.00099}%
	\def \pgfplots@loc@TMPa {{0.0,0.0,0.0},{1.0,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@initial}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@initial}%
		\fi 
	}%
	\def \pgfpl@cm@initial@colspace {rgb}%
	\def \pgfpl@cm@initial@col@comps {3}%
	\def \pgfpl@cm@initial@lastindex {1}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@initial@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@initial@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\initial}{unexpected initial}
}

{
\pgfplotsset{
	colormap={actual}{
		color of colormap=(250 of initial) 
		color of colormap=(750 of initial)
	},
}
\pgfplotscolormapserializetomacro{actual}\simpleofcolormap
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {1000.0}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.00099}%
	\def \pgfplots@loc@TMPa {{0.24796,0.0,0.0},{0.74387,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {1}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\simpleofcolormap}{unexpected actual}
}

{
\pgfplotsset{
	colormap={actual}{
		color=(red) 
		color of colormap(10pt)=(250 of initial) 
		color of colormap(30pt)=(750 of initial)
	},
}
\pgfplotscolormapserializetomacro{actual}\ofcolormapwithpositions
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {333.33328}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.00299}%
	\def \pgfplots@loc@TMPa {{1.0,0.0,0.0},{0.24796,0.0,0.0},{0.49591,0.0,0.0},{0.74387,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {3}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\ofcolormapwithpositions}{unexpected actual}
}

{
\pgfplotsset{
	colormap={actual}{
		colors of colormap=({250,750} of initial) 
	},
}
\pgfplotscolormapserializetomacro{actual}\simpleofcolormap
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {1000.0}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.00099}%
	\def \pgfplots@loc@TMPa {{0.24796,0.0,0.0},{0.74387,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {1}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\simpleofcolormap}{unexpected colors of colormap}
}

{
\pgfplotsset{
	colormap={actual}{
		color=(red) 
		colors of colormap(10pt)=({250,500,750} of initial) 
	},
}
\pgfplotscolormapserializetomacro{actual}\ofcolormapwithpositions
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {333.33328}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.00299}%
	\def \pgfplots@loc@TMPa {{1.0,0.0,0.0},{0.24796,0.0,0.0},{0.49591,0.0,0.0},{0.74387,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {3}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\ofcolormapwithpositions}{unexpected colors of colormap with pos}
}

{
\pgfplotsset{
	colormap={actual}{
		color=(red) 
		color(10pt)=(red)
		colors of colormap(30pt)=({250,500,750} of initial) 
	},
}
\pgfplotscolormapserializetomacro{actual}\ofcolormapwithpositions
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {200.0}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.00499}%
	\def \pgfplots@loc@TMPa {{1.0,0.0,0.0},{1.0,0.0,0.0},{0.62398,0.0,0.0},{0.24796,0.0,0.0},{0.49591,0.0,0.0},{0.74387,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {5}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\ofcolormapwithpositions}{unexpected colors of colormap with pos}
}

{
\pgfplotsset{
	colormap={actual}{
		color=(red) 
		color(10pt)=(red)
		indices of colormap(30pt)=({1,0} of initial) 
	},
}
\pgfplotscolormapserializetomacro{actual}\ofcolormapwithpositions
\def\expected{%
	\expandafter \def \csname pgfpl@cm@actual@h\endcsname {250.0}%
	\expandafter \def \csname pgfpl@cm@actual@invh\endcsname {0.004}%
	\def \pgfplots@loc@TMPa {{1.0,0.0,0.0},{1.0,0.0,0.0},{1.0,0.0,0.0},{1.0,0.0,0.0},{0.0,0.0,0.0}}%
	\pgfplotsarraynewempty {pgfpl@cm@actual}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual}%
		\fi 
	}%
	\def \pgfpl@cm@actual@colspace {rgb}%
	\def \pgfpl@cm@actual@col@comps {3}%
	\def \pgfpl@cm@actual@lastindex {4}%
	\def \pgfplots@loc@TMPa {}%
	\pgfplotsarraynewempty {pgfpl@cm@actual@X}%
	\expandafter \pgfplotsutilforeachcommasep \pgfplots@loc@TMPa \as \pgfplots@loc@TMPb {%
		\ifx \pgfplots@loc@TMPb \pgfutil@empty \else 
			\expandafter \pgfplotsarraypushback \pgfplots@loc@TMPb \to {pgfpl@cm@actual@X}%
		\fi 
	}%
}%
\pgfplotsassertequalstoknoexpand{\expected}{\ofcolormapwithpositions}{unexpected indices of colormap with pos}
}
\end{document}

